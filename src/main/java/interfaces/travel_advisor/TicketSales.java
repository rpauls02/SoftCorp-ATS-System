
/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package interfaces.travel_advisor;

import SQL.DBConnection;
import customer.Customer;
import customer.RegularCustomer;
import customer.ValuedCustomer;
import interfaces.general.Login;
import org.json.JSONObject;

import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.math.BigDecimal;
import java.net.HttpURLConnection;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.time.LocalDate;
import java.util.Objects;
import java.util.Random;

import java.net.URL;
import java.util.Scanner;

import sale.ExchangeRate;
import staff.StaffController;

/**
 *
 * @author Abdullah
 */
public class TicketSales extends javax.swing.JFrame {

    private Login previousPage = new Login();

    /**
     * Creates new form ticketSalesFrame
     */
    public TicketSales() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        ticketSalesPanel = new javax.swing.JPanel();
        buttonsPanel = new javax.swing.JPanel();
        homeButton = new javax.swing.JButton();
        viewIndSalesButton = new javax.swing.JButton();
        logoutButton = new javax.swing.JButton();
        viewTicketsPageButton = new javax.swing.JButton();
        sellTicketPageButton = new javax.swing.JButton();
        customerDetailsPanel = new javax.swing.JPanel();
        customerDetailsLabel = new javax.swing.JLabel();
        cardDetailsPanel = new javax.swing.JPanel();
        cardDetailsPanelLabel = new javax.swing.JLabel();
        cardNumberLabel = new javax.swing.JLabel();
        cardNumberField = new javax.swing.JTextField();
        cardNameLabel = new javax.swing.JLabel();
        cardNameField = new javax.swing.JTextField();
        issueNoLabel = new javax.swing.JLabel();
        issueNoField = new javax.swing.JTextField();
        expDateLabel = new javax.swing.JLabel();
        expDateField = new javax.swing.JTextField();
        cvvLabel = new javax.swing.JLabel();
        cvvField = new javax.swing.JTextField();
        existingCustomerPanel = new javax.swing.JPanel();
        existingCustomerPanelLabel = new javax.swing.JLabel();
        customerNameLabel = new javax.swing.JLabel();
        selectCustomerButton = new javax.swing.JButton();
        customerNameDDMenu = new javax.swing.JComboBox<>();
        findCustomerButton = new javax.swing.JButton();
        newCustomerPanel = new javax.swing.JPanel();
        newCustomerPanelLabel = new javax.swing.JLabel();
        forenameLabel = new javax.swing.JLabel();
        forenameField = new javax.swing.JTextField();
        surnameLabel = new javax.swing.JLabel();
        surnameField = new javax.swing.JTextField();
        phoneField = new javax.swing.JTextField();
        emailLabel = new javax.swing.JLabel();
        emailField = new javax.swing.JTextField();
        phoneLabel = new javax.swing.JLabel();
        ticketDetailsPanel = new javax.swing.JPanel();
        ticketDetailsLabel = new javax.swing.JLabel();
        saleDateLabel = new javax.swing.JLabel();
        typeOfSaleLabel = new javax.swing.JLabel();
        selectBlankLabel = new javax.swing.JLabel();
        createTicketButton = new javax.swing.JButton();
        typeOfSaleDDMenu = new javax.swing.JComboBox<>();
        convertedAmountPanel = new javax.swing.JPanel();
        iataCurrencyCodeDDMenu = new javax.swing.JComboBox<>();
        IATACurrencyCodeLabel = new javax.swing.JLabel();
        exchangeRateLabel = new javax.swing.JLabel();
        showRateLabel = new javax.swing.JLabel();
        blankListSP = new javax.swing.JScrollPane();
        blankList = new javax.swing.JList<>();
        payLaterLabel = new javax.swing.JLabel();
        plYesCheckbox = new javax.swing.JCheckBox();
        plNoCheckbox = new javax.swing.JCheckBox();
        subtotalLabel = new javax.swing.JLabel();
        subtotalAmtLabel = new javax.swing.JLabel();
        taxLabel = new javax.swing.JLabel();
        taxAmountLabel = new javax.swing.JLabel();
        otherLabel = new javax.swing.JLabel();
        otherAmtLabel = new javax.swing.JLabel();
        usdPayableLabel = new javax.swing.JLabel();
        usdAmtLabel = new javax.swing.JLabel();
        iataPayableLabel = new javax.swing.JLabel();
        iataAmtLabel = new javax.swing.JLabel();
        dateLabel = new javax.swing.JLabel();
        paymentTypeLabel = new javax.swing.JLabel();
        paymentTypeDDMenu = new javax.swing.JComboBox<>();
        pageTitlePanel = new javax.swing.JPanel();
        pageTitleLabel = new javax.swing.JLabel();
        logoPanel = new javax.swing.JPanel();
        logoLabel = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("ATS System | Travel Advisor | Ticket Sales");
        setResizable(false);

        buttonsPanel.setBackground(new java.awt.Color(49, 174, 209));
        buttonsPanel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        buttonsPanel.setPreferredSize(new java.awt.Dimension(572, 104));

        homeButton.setBackground(new java.awt.Color(54, 198, 238));
        homeButton.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        homeButton.setText("Home");
        homeButton.setPreferredSize(new java.awt.Dimension(79, 42));
        homeButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                homeButtonActionPerformed(evt);
            }
        });

        viewIndSalesButton.setBackground(new java.awt.Color(54, 198, 238));
        viewIndSalesButton.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        viewIndSalesButton.setText("View Individual Sales Report");
        viewIndSalesButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                viewIndSalesButtonActionPerformed(evt);
            }
        });

        logoutButton.setBackground(new java.awt.Color(255, 102, 102));
        logoutButton.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        logoutButton.setText("Log Out");
        logoutButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                logoutButtonActionPerformed(evt);
            }
        });

        viewTicketsPageButton.setBackground(new java.awt.Color(54, 198, 238));
        viewTicketsPageButton.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        viewTicketsPageButton.setText("View Customer Tickets");
        viewTicketsPageButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                viewTicketsPageButtonActionPerformed(evt);
            }
        });

        sellTicketPageButton.setBackground(new java.awt.Color(153, 153, 255));
        sellTicketPageButton.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        sellTicketPageButton.setText("Sell Ticket");

        javax.swing.GroupLayout buttonsPanelLayout = new javax.swing.GroupLayout(buttonsPanel);
        buttonsPanel.setLayout(buttonsPanelLayout);
        buttonsPanelLayout.setHorizontalGroup(
                buttonsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(buttonsPanelLayout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(buttonsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                        .addGroup(buttonsPanelLayout.createSequentialGroup()
                                                .addComponent(homeButton, javax.swing.GroupLayout.DEFAULT_SIZE, 124, Short.MAX_VALUE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(viewIndSalesButton, javax.swing.GroupLayout.DEFAULT_SIZE, 298, Short.MAX_VALUE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(logoutButton, javax.swing.GroupLayout.PREFERRED_SIZE, 124, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addGroup(buttonsPanelLayout.createSequentialGroup()
                                                .addComponent(sellTicketPageButton, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(viewTicketsPageButton, javax.swing.GroupLayout.PREFERRED_SIZE, 277, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addContainerGap())
        );
        buttonsPanelLayout.setVerticalGroup(
                buttonsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(buttonsPanelLayout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(buttonsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                        .addComponent(logoutButton, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(viewIndSalesButton, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(homeButton, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addGap(6, 6, 6)
                                .addGroup(buttonsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(viewTicketsPageButton, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(sellTicketPageButton, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(2, 2, 2))
        );

        customerDetailsPanel.setBackground(new java.awt.Color(49, 174, 209));
        customerDetailsPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        customerDetailsPanel.setPreferredSize(new java.awt.Dimension(588, 678));

        customerDetailsLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        customerDetailsLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        customerDetailsLabel.setText("Customer Details");
        customerDetailsLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        cardDetailsPanel.setBackground(new java.awt.Color(49, 174, 209));
        cardDetailsPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        cardDetailsPanelLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        cardDetailsPanelLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        cardDetailsPanelLabel.setText("Customer Card Details");
        cardDetailsPanelLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        cardNumberLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        cardNumberLabel.setText("Card Number:");

        cardNumberField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        cardNameLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        cardNameLabel.setText("Card Name:");

        cardNameField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        issueNoLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        issueNoLabel.setText("Issue No.(if applicable):");

        issueNoField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        expDateLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        expDateLabel.setText("Expiry Date:");

        expDateField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        cvvLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        cvvLabel.setText("CVV:");

        cvvField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        javax.swing.GroupLayout cardDetailsPanelLayout = new javax.swing.GroupLayout(cardDetailsPanel);
        cardDetailsPanel.setLayout(cardDetailsPanelLayout);
        cardDetailsPanelLayout.setHorizontalGroup(
                cardDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(cardDetailsPanelLayout.createSequentialGroup()
                                .addGap(16, 16, 16)
                                .addGroup(cardDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(cardDetailsPanelLayout.createSequentialGroup()
                                                .addComponent(cardNumberLabel)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(cardNumberField))
                                        .addGroup(cardDetailsPanelLayout.createSequentialGroup()
                                                .addComponent(cardNameLabel)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(cardNameField))
                                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, cardDetailsPanelLayout.createSequentialGroup()
                                                .addComponent(issueNoLabel)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(issueNoField, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGap(18, 20, Short.MAX_VALUE)
                                                .addComponent(expDateLabel)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(expDateField, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGap(18, 18, 18)
                                                .addComponent(cvvLabel)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(cvvField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addGap(16, 16, 16))
                        .addComponent(cardDetailsPanelLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        cardDetailsPanelLayout.setVerticalGroup(
                cardDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, cardDetailsPanelLayout.createSequentialGroup()
                                .addComponent(cardDetailsPanelLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, Short.MAX_VALUE)
                                .addGroup(cardDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(cardNumberField, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(cardNumberLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(cardDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(cardNameLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(cardNameField, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(cardDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(cvvField, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(cvvLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(expDateLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(expDateField, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(issueNoField, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(issueNoLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18))
        );

        expDateLabel.getAccessibleContext().setAccessibleDescription("");

        existingCustomerPanel.setBackground(new java.awt.Color(49, 174, 209));
        existingCustomerPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        existingCustomerPanelLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        existingCustomerPanelLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        existingCustomerPanelLabel.setText("Select Existing Customer");
        existingCustomerPanelLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        customerNameLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        customerNameLabel.setText("Name:");

        selectCustomerButton.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        selectCustomerButton.setText("Select");
        selectCustomerButton.setPreferredSize(new java.awt.Dimension(76, 30));
        selectCustomerButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                selectCustomerButtonActionPerformed(evt);
            }
        });

        customerNameDDMenu.setEditable(true);
        customerNameDDMenu.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        findCustomerButton.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        findCustomerButton.setText("Find");
        findCustomerButton.setPreferredSize(new java.awt.Dimension(72, 30));
        findCustomerButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                findCustomerButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout existingCustomerPanelLayout = new javax.swing.GroupLayout(existingCustomerPanel);
        existingCustomerPanel.setLayout(existingCustomerPanelLayout);
        existingCustomerPanelLayout.setHorizontalGroup(
                existingCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(existingCustomerPanelLayout.createSequentialGroup()
                                .addGap(16, 16, 16)
                                .addComponent(customerNameLabel)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(customerNameDDMenu, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(findCustomerButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(selectCustomerButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addContainerGap())
                        .addComponent(existingCustomerPanelLabel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        existingCustomerPanelLayout.setVerticalGroup(
                existingCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(existingCustomerPanelLayout.createSequentialGroup()
                                .addComponent(existingCustomerPanelLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addGroup(existingCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(existingCustomerPanelLayout.createSequentialGroup()
                                                .addComponent(customerNameLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGap(0, 0, Short.MAX_VALUE))
                                        .addGroup(existingCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                                .addComponent(customerNameDDMenu)
                                                .addComponent(selectCustomerButton, javax.swing.GroupLayout.DEFAULT_SIZE, 32, Short.MAX_VALUE)
                                                .addComponent(findCustomerButton, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                                .addGap(18, 18, 18))
        );

        newCustomerPanel.setBackground(new java.awt.Color(49, 174, 209));
        newCustomerPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        newCustomerPanelLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        newCustomerPanelLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        newCustomerPanelLabel.setText("Add New Customer");
        newCustomerPanelLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        forenameLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        forenameLabel.setText("Forename:");

        forenameField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        surnameLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        surnameLabel.setText("Surname:");

        surnameField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        phoneField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        emailLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        emailLabel.setText("Email:");

        emailField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        phoneLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        phoneLabel.setText("Phone:");

        javax.swing.GroupLayout newCustomerPanelLayout = new javax.swing.GroupLayout(newCustomerPanel);
        newCustomerPanel.setLayout(newCustomerPanelLayout);
        newCustomerPanelLayout.setHorizontalGroup(
                newCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(newCustomerPanelLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(newCustomerPanelLayout.createSequentialGroup()
                                .addGap(16, 16, 16)
                                .addGroup(newCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(newCustomerPanelLayout.createSequentialGroup()
                                                .addComponent(surnameLabel)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(surnameField))
                                        .addGroup(newCustomerPanelLayout.createSequentialGroup()
                                                .addComponent(forenameLabel)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(forenameField, javax.swing.GroupLayout.DEFAULT_SIZE, 447, Short.MAX_VALUE))
                                        .addGroup(newCustomerPanelLayout.createSequentialGroup()
                                                .addComponent(emailLabel)
                                                .addGroup(newCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                        .addGroup(newCustomerPanelLayout.createSequentialGroup()
                                                                .addGap(14, 14, 14)
                                                                .addComponent(phoneField))
                                                        .addGroup(newCustomerPanelLayout.createSequentialGroup()
                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(emailField))))
                                        .addComponent(phoneLabel))
                                .addGap(16, 16, 16))
        );
        newCustomerPanelLayout.setVerticalGroup(
                newCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(newCustomerPanelLayout.createSequentialGroup()
                                .addComponent(newCustomerPanelLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addGroup(newCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(forenameField, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(forenameLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(newCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(surnameLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(surnameField, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(newCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(emailLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(emailField, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(newCustomerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                        .addComponent(phoneField, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(phoneLabel))
                                .addContainerGap())
        );

        javax.swing.GroupLayout customerDetailsPanelLayout = new javax.swing.GroupLayout(customerDetailsPanel);
        customerDetailsPanel.setLayout(customerDetailsPanelLayout);
        customerDetailsPanelLayout.setHorizontalGroup(
                customerDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(customerDetailsPanelLayout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(customerDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(customerDetailsLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(existingCustomerPanel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(cardDetailsPanel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(newCustomerPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addContainerGap())
        );
        customerDetailsPanelLayout.setVerticalGroup(
                customerDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(customerDetailsPanelLayout.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(customerDetailsLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(existingCustomerPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(newCustomerPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(cardDetailsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addContainerGap(42, Short.MAX_VALUE))
        );

        ticketDetailsPanel.setBackground(new java.awt.Color(49, 174, 209));
        ticketDetailsPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        ticketDetailsPanel.setPreferredSize(new java.awt.Dimension(594, 477));

        ticketDetailsLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        ticketDetailsLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        ticketDetailsLabel.setText("Sale Details");
        ticketDetailsLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        saleDateLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        saleDateLabel.setText("Date:");

        typeOfSaleLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        typeOfSaleLabel.setText("Type:");

        selectBlankLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        selectBlankLabel.setText("Select Blank:");

        createTicketButton.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        createTicketButton.setText("Create Ticket");
        createTicketButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                createTicketButtonActionPerformed(evt);
            }
        });

        typeOfSaleDDMenu.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        typeOfSaleDDMenu.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Select Sale Type", "Interline", "Domestic" }));

        convertedAmountPanel.setBackground(new java.awt.Color(49, 174, 209));
        convertedAmountPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        convertedAmountPanel.setMaximumSize(new java.awt.Dimension(514, 207));
        convertedAmountPanel.setMinimumSize(new java.awt.Dimension(514, 207));
        convertedAmountPanel.setPreferredSize(new java.awt.Dimension(514, 207));
        convertedAmountPanel.setRequestFocusEnabled(false);

        iataCurrencyCodeDDMenu.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        iataCurrencyCodeDDMenu.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Select IATA Code", "AED", "AFN", "ALL", "AMD", "ANG", "AOA", "ARS", "AUD", "AWG", "AZN", "BAM", "BBD", "BDT", "BGN", "BHD", "BIF", "BMD", "BND", "BOB", "BOV", "BRL", "BSD", "BTN", "BWP", "BYN", "BZD", "CAD", "CDF", "CHE", "CHF", "CHW", "CLF", "CLP", "CNY", "COP", "COU", "CRC", "CUC", "CUP", "CVE", "CZK", "DJF", "DKK", "DOP", "DZD", "EGP", "ERN", "ETB", "EUR", "FJD", "FKP", "GBP", "GEL", "GHS", "GIP", "GMD", "GNF", "GTQ", "GYD", "HKD", "HNL", "HRK", "HTG", "HUF", "IDR", "ILS", "INR", "IQD", "IRR", "ISK", "JMD", "JOD", "JPY", "KES", "KGS", "KHR", "KMF", "KPW", "KRW", "KWD", "KYD", "KZT", "LAK", "LBP", "LKR", "LRD", "LSL", "LYD", "MAD", "MDL", "MGA", "MKD", "MMK", "MNT", "MOP", "MRU", "MVR", "MWK", "MXN", "MXV", "MYR", "MZN", "NAD", "NGN", "NIO", "NOK", "NPR", "NZD", "OMR", "PAB", "PEN", "PGK", "PHP", "PKR", "PLN", "PYG", "QAR", "RON", "RSD", "RUB", "RWF", "SAR", "SBD", "SCR", "SDG", "SEK", "SGD", "SHP", "SLE", "SOS", "SRD", "SSP", "STN", "SVC", "SYP", "SZL", "THB", "TJS", "TMT", "TND", "TOP", "TRY", "TTD", "TWD", "TZS", "UAH", "UGX", "USD", "USN", "UYI", "UYU", "UZS", "VED", "VEF", "BND", "VUV", "WST", "XAF", "XCD", "XOF", "XPF", "XSU", "XUA", "YER", "ZAR", "ZMW", "ZWL" }));
        iataCurrencyCodeDDMenu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                iataCurrencyCodeDDMenuActionPerformed(evt);
            }
        });

        IATACurrencyCodeLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        IATACurrencyCodeLabel.setText("IATA Currency Code:");

        exchangeRateLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        exchangeRateLabel.setText("Exchange Rate:");

        showRateLabel.setBackground(new java.awt.Color(255, 255, 255));
        showRateLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        showRateLabel.setForeground(new java.awt.Color(255, 255, 255));
        showRateLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        javax.swing.GroupLayout convertedAmountPanelLayout = new javax.swing.GroupLayout(convertedAmountPanel);
        convertedAmountPanel.setLayout(convertedAmountPanelLayout);
        convertedAmountPanelLayout.setHorizontalGroup(
                convertedAmountPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(convertedAmountPanelLayout.createSequentialGroup()
                                .addGap(16, 16, 16)
                                .addGroup(convertedAmountPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addGroup(convertedAmountPanelLayout.createSequentialGroup()
                                                .addComponent(IATACurrencyCodeLabel)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(iataCurrencyCodeDDMenu, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                        .addGroup(convertedAmountPanelLayout.createSequentialGroup()
                                                .addComponent(exchangeRateLabel)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(showRateLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 408, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addGap(16, 26, Short.MAX_VALUE))
        );
        convertedAmountPanelLayout.setVerticalGroup(
                convertedAmountPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(convertedAmountPanelLayout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(convertedAmountPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(IATACurrencyCodeLabel, javax.swing.GroupLayout.DEFAULT_SIZE, 30, Short.MAX_VALUE)
                                        .addComponent(iataCurrencyCodeDDMenu, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                                .addGap(18, 18, 18)
                                .addGroup(convertedAmountPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(exchangeRateLabel, javax.swing.GroupLayout.DEFAULT_SIZE, 30, Short.MAX_VALUE)
                                        .addComponent(showRateLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        blankList.setBackground(new java.awt.Color(49, 174, 209));
        blankList.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        blankList.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        blankList.setSelectionBackground(new java.awt.Color(0, 204, 255));
        blankListSP.setViewportView(blankList);

        Connection conn = null;
        PreparedStatement pstm = null;
        ResultSet rs = null;
        DefaultListModel<String> model = new DefaultListModel<>();
        StaffController staffController = new StaffController();

        try{
            conn = DBConnection.getConnection();
            String query = "SELECT * FROM blank WHERE staffID = ?";
            pstm = conn.prepareStatement(query);
//            pstm.setInt(1, staffController.getAdvisor().getId());
            pstm.executeUpdate();
            while (rs.next()){
                String blankNumber = rs.getString("number");
                model.addElement(blankNumber);
            }
        } catch (SQLException sqle){

        } finally {
            try { if (conn != null) conn.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (pstm != null) pstm.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (rs != null) rs.close(); } catch (Exception e) { throw new RuntimeException(e); }
        }

        payLaterLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        payLaterLabel.setText("Pay Later?:");

        plYesCheckbox.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        plYesCheckbox.setText("Yes");

        plNoCheckbox.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        plNoCheckbox.setText("No");
        subtotalLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        subtotalLabel.setText("Subtotal:");

        subtotalAmtLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        subtotalAmtLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        taxLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        taxLabel.setText("Tax:");

        taxAmountLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        taxAmountLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        otherLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        otherLabel.setText("Other:");

        otherAmtLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        otherAmtLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        usdPayableLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        usdPayableLabel.setText("Amount Payable (USD):");

        usdAmtLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        usdAmtLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        iataPayableLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        iataPayableLabel.setText("Amount Payable (IATA):");

        iataAmtLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        iataAmtLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        dateLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        dateLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        paymentTypeLabel.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        paymentTypeLabel.setText("Payment Type:");
        paymentTypeLabel.setPreferredSize(new java.awt.Dimension(116, 30));

        paymentTypeDDMenu.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        paymentTypeDDMenu.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Select Payment Type", "Card", "Cash" }));
        paymentTypeDDMenu.setMinimumSize(new java.awt.Dimension(206, 30));
        paymentTypeDDMenu.setPreferredSize(new java.awt.Dimension(206, 30));

        javax.swing.GroupLayout ticketDetailsPanelLayout = new javax.swing.GroupLayout(ticketDetailsPanel);
        ticketDetailsPanel.setLayout(ticketDetailsPanelLayout);
        ticketDetailsPanelLayout.setHorizontalGroup(
                ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(ticketDetailsLabel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, ticketDetailsPanelLayout.createSequentialGroup()
                                                .addGap(22, 22, 22)
                                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, ticketDetailsPanelLayout.createSequentialGroup()
                                                                .addGap(0, 0, Short.MAX_VALUE)
                                                                .addComponent(createTicketButton))
                                                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                                                        .addGroup(javax.swing.GroupLayout.Alignment.LEADING, ticketDetailsPanelLayout.createSequentialGroup()
                                                                                .addComponent(selectBlankLabel)
                                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                .addComponent(blankListSP))
                                                                        .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                                                        .addComponent(saleDateLabel)
                                                                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                        .addComponent(dateLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 483, javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                                                                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                                                                .addComponent(usdPayableLabel)
                                                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                .addComponent(usdAmtLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                                                                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                                                                .addComponent(iataPayableLabel)
                                                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                .addComponent(iataAmtLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                                                                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, ticketDetailsPanelLayout.createSequentialGroup()
                                                                                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                                                                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                                                                                .addComponent(taxLabel)
                                                                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                .addComponent(taxAmountLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                                                                                .addComponent(payLaterLabel)
                                                                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                                                                .addComponent(plYesCheckbox)
                                                                                                                .addGap(18, 18, 18)
                                                                                                                .addComponent(plNoCheckbox)))
                                                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 33, Short.MAX_VALUE)
                                                                                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                                                                                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                                                                                .addComponent(subtotalLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                .addComponent(subtotalAmtLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                                                                                .addComponent(otherLabel)
                                                                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                                                                .addComponent(otherAmtLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))))
                                                                                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                                                                .addComponent(typeOfSaleLabel)
                                                                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                .addComponent(typeOfSaleDDMenu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                                .addGap(18, 18, 18)
                                                                                                .addComponent(paymentTypeLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                                                                        .addComponent(paymentTypeDDMenu, javax.swing.GroupLayout.PREFERRED_SIZE, 173, javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                .addGap(0, 26, Short.MAX_VALUE))))
                                        .addComponent(convertedAmountPanel, javax.swing.GroupLayout.DEFAULT_SIZE, 578, Short.MAX_VALUE))
                                .addContainerGap())
        );
        ticketDetailsPanelLayout.setVerticalGroup(
                ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(ticketDetailsLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(saleDateLabel, javax.swing.GroupLayout.DEFAULT_SIZE, 30, Short.MAX_VALUE)
                                        .addComponent(dateLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addGap(18, 18, 18)
                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(typeOfSaleLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                                .addComponent(paymentTypeLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addComponent(paymentTypeDDMenu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addComponent(typeOfSaleDDMenu, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addComponent(convertedAmountPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 94, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(ticketDetailsPanelLayout.createSequentialGroup()
                                                .addComponent(selectBlankLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGap(0, 125, Short.MAX_VALUE))
                                        .addComponent(blankListSP))
                                .addGap(18, 18, 18)
                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                                .addComponent(subtotalLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                .addComponent(payLaterLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                .addComponent(plYesCheckbox)
                                                .addComponent(plNoCheckbox))
                                        .addComponent(subtotalAmtLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                                .addComponent(taxLabel, javax.swing.GroupLayout.DEFAULT_SIZE, 30, Short.MAX_VALUE)
                                                .addComponent(taxAmountLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                        .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                                .addComponent(otherLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                .addComponent(otherAmtLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addGap(18, 18, 18)
                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(usdPayableLabel, javax.swing.GroupLayout.DEFAULT_SIZE, 30, Short.MAX_VALUE)
                                        .addComponent(usdAmtLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addGap(18, 18, 18)
                                .addGroup(ticketDetailsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(iataPayableLabel, javax.swing.GroupLayout.DEFAULT_SIZE, 30, Short.MAX_VALUE)
                                        .addComponent(iataAmtLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addGap(18, 18, 18)
                                .addComponent(createTicketButton)
                                .addContainerGap())
        );

        convertedAmountPanel.getAccessibleContext().setAccessibleName("");

        pageTitlePanel.setBackground(new java.awt.Color(49, 174, 209));
        pageTitlePanel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        pageTitlePanel.setMaximumSize(new java.awt.Dimension(478, 75));
        pageTitlePanel.setMinimumSize(new java.awt.Dimension(478, 75));

        pageTitleLabel.setBackground(new java.awt.Color(153, 204, 255));
        pageTitleLabel.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N
        pageTitleLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        pageTitleLabel.setText("Ticket Sales ");

        javax.swing.GroupLayout pageTitlePanelLayout = new javax.swing.GroupLayout(pageTitlePanel);
        pageTitlePanel.setLayout(pageTitlePanelLayout);
        pageTitlePanelLayout.setHorizontalGroup(
                pageTitlePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(pageTitleLabel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        pageTitlePanelLayout.setVerticalGroup(
                pageTitlePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pageTitlePanelLayout.createSequentialGroup()
                                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(pageTitleLabel)
                                .addGap(35, 35, 35))
        );

        logoPanel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        logoPanel.setPreferredSize(new java.awt.Dimension(104, 104));

        //logoLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/data/smallLogo.png"))); // NOI18N
        ImageIcon logo = new ImageIcon("data/smallLogo.png");
        logoLabel.setIcon(logo);
        logoPanel.add(logoLabel);
        getContentPane().add(logoPanel);

        javax.swing.GroupLayout logoPanelLayout = new javax.swing.GroupLayout(logoPanel);
        logoPanel.setLayout(logoPanelLayout);
        logoPanelLayout.setHorizontalGroup(
                logoPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGap(0, 102, Short.MAX_VALUE)
                        .addGroup(logoPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(logoPanelLayout.createSequentialGroup()
                                        .addGap(0, 0, Short.MAX_VALUE)
                                        .addComponent(logoLabel)
                                        .addGap(0, 0, Short.MAX_VALUE)))
        );
        logoPanelLayout.setVerticalGroup(
                logoPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addGroup(logoPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(logoPanelLayout.createSequentialGroup()
                                        .addGap(0, 0, Short.MAX_VALUE)
                                        .addComponent(logoLabel)
                                        .addGap(0, 0, Short.MAX_VALUE)))
        );

        javax.swing.GroupLayout ticketSalesPanelLayout = new javax.swing.GroupLayout(ticketSalesPanel);
        ticketSalesPanel.setLayout(ticketSalesPanelLayout);
        ticketSalesPanelLayout.setHorizontalGroup(
                ticketSalesPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(ticketSalesPanelLayout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(ticketSalesPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(ticketSalesPanelLayout.createSequentialGroup()
                                                .addComponent(customerDetailsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(ticketDetailsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                        .addGroup(ticketSalesPanelLayout.createSequentialGroup()
                                                .addComponent(logoPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(pageTitlePanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(buttonsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addContainerGap())
        );
        ticketSalesPanelLayout.setVerticalGroup(
                ticketSalesPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(ticketSalesPanelLayout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(ticketSalesPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                        .addComponent(pageTitlePanel, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(logoPanel, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(buttonsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(ticketSalesPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(ticketDetailsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, 678, Short.MAX_VALUE)
                                        .addComponent(customerDetailsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGap(0, 1200, Short.MAX_VALUE)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(layout.createSequentialGroup()
                                        .addGap(0, 0, Short.MAX_VALUE)
                                        .addComponent(ticketSalesPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(0, 0, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGap(0, 800, Short.MAX_VALUE)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(layout.createSequentialGroup()
                                        .addGap(0, 0, Short.MAX_VALUE)
                                        .addComponent(ticketSalesPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(0, 0, Short.MAX_VALUE)))
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>

    private void homeButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_homeButtonActionPerformed
        dispose();
        new TravelAdvisorHub().setVisible(true);
    }//GEN-LAST:event_homeButtonActionPerformed

    private void logoutButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_logoutButtonActionPerformed
        dispose();
        new Login().setVisible(true);
    }//GEN-LAST:event_logoutButtonActionPerformed

    private void viewTicketsPageButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_viewTicketsPageButtonActionPerformed
        dispose();
        //new ViewTickets().setVisible(true);
    }//GEN-LAST:event_viewTicketsPageButtonActionPerformed

    private void viewIndSalesButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_viewIndSalesButtonActionPerformed
        dispose();
        new GenerateIndividualReport().setVisible(true);
    }//GEN-LAST:event_viewIndSalesButtonActionPerformed

    private void typeOfSaleDDMenuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_typeOfSaleDDActionPerformed
        if (Objects.equals(typeOfSaleDDMenu.getSelectedItem(), "Domestic")){
            convertedAmountPanel.setBackground(Color.GRAY);
            convertedAmountPanel.setOpaque(true);
            convertedAmountPanel.setEnabled(false);
            iataCurrencyCodeDDMenu.setEnabled(false);
            showRateLabel.setText(" ");
        } else {
            convertedAmountPanel.setBackground(new Color(49,174,209));
            convertedAmountPanel.setOpaque(false);
            convertedAmountPanel.setEnabled(true);
            iataCurrencyCodeDDMenu.setEnabled(true);
        }
    }//GEN-LAST:event_typeOfSaleDDActionPerformed


    /*
    * Finding Customer from the database
    1. Connection is made to the database.
    2. There is a search query to find customers by surname.
    3. The query is executed and gets the results, which are the forename and surname of the customers whose surname matches the one entered by the user.
    4. The program removes all the items from the customer name dropdown menu (a list of customer names that the user can choose from).
    5. The program goes through the results of the query one by one.
    6. For each result, the program gets the forename and surname of the customer.
    7. The program combines the forename and surname into a single string and adds it to the customer name dropdown menu.
    8. If there is an error during the search process, such as an incorrect name being entered, the program shows an error message to the user.
    *
    * */

    private void findCustomerButtonActionPerformed(java.awt.event.ActionEvent evt) {
        Connection conn = null;
        PreparedStatement pstm = null;
        ResultSet rs = null;
        try {
            conn = DBConnection.getConnection();
            String query = "SELECT forename, surname FROM in2018g12.customer WHERE surname = ?";
            pstm = conn.prepareStatement(query);
            pstm.setString(1, ((JTextField)customerNameDDMenu.getEditor().getEditorComponent()).getText());
            rs = pstm.executeQuery();
            customerNameDDMenu.removeAllItems(); // Remove all items from the combo box
            while (rs.next()) {
                String forename = rs.getString("forename");
                String surname = rs.getString("surname");
                customerNameDDMenu.addItem(forename + " " +  surname); // Add the retrieved names to the combo box
            }
        } catch (SQLException sqle) {
            JOptionPane.showMessageDialog(this, "Could not find customer. " +
                    "Review name entered");
        } finally {
            try { if (conn != null) conn.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (pstm != null) pstm.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (rs != null) rs.close(); } catch (Exception e) { throw new RuntimeException(e); }
        }
    }

   /*
    * Selecting Customer from the Database
    1. The customer name selected from a dropdown menu is retrieved and split into its first and last name components.
    2. The method then prepares and executes a query to retrieve the customer's details from the database.
    3. If the query returns a result, the method retrieves the details of the customer's associated card from the database.
    4. If the card details are also retrieved successfully, the method creates a new Customer object with the retrieved customer details.
    5. The retrieved customer and card details are then displayed in text fields on the User Interface.
    *
    * */

    private void selectCustomerButtonActionPerformed(java.awt.event.ActionEvent evt) {
        Connection conn = null;
        PreparedStatement pstm1 = null;
        PreparedStatement pstm2 = null;
        ResultSet rs1 = null;
        ResultSet rs2 = null;
        try {
            conn = DBConnection.getConnection();
            conn.setAutoCommit(false);
            String selectedName = (String) customerNameDDMenu.getSelectedItem();
            String[] nameParts = selectedName.split(" ");
            String query1 = "SELECT * FROM in2018g12.customer WHERE forename = ? AND surname = ?";
            pstm1 = conn.prepareStatement(query1);
            pstm1.setString(1, nameParts[0]);
            pstm1.setString(2, nameParts[1]);
            rs1 = pstm1.executeQuery();
            if (rs1.next()) {
                String customerUsername = rs1.getString("customerUsername");
                String query2 = "SELECT * FROM in2018g12.card WHERE customerUsername = ?";
                pstm2 = conn.prepareStatement(query2);
                pstm2.setString(1, customerUsername);
                rs2 = pstm2.executeQuery();
                if (rs2.next()) {
                    String cardNumber = rs2.getString("card_number");
                    String expiryDate = rs2.getString("expiry_date");
                    String cvv = rs2.getString("cvv");
                    String forename = rs1.getString("forename");
                    String surname = rs1.getString("surname");
                    String email = rs1.getString("email");
                    String phone = rs1.getString("phone");
                    Customer customer = new Customer
                            (rs1.getString("username"), rs1.getString("forename"), rs1.getString("surname"), rs1.getString("address"),
                                    rs1.getString("postcode"), rs1.getString("phone"), rs1.getString("email"), rs1.getString("status"));
                    // Set retrieved details to the fields below the "Select Existing Customer" section
                    cardNumberField.setText(cardNumber);
                    issueNoField.setText(expiryDate);
                    cvvField.setText(cvv);
                    forenameField.setText(forename);
                    surnameField.setText(surname);
                    emailField.setText(email);
                    phoneField.setText(phone);
                }
                conn.commit();
                conn.setAutoCommit(true);
            }
        } catch (SQLException sqle) {
            JOptionPane.showMessageDialog(this, "Could not select customer. " +
                    "Review customer selection or contact system administrator");
        } finally {
            try { if (conn != null) conn.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (pstm1 != null) pstm1.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (rs1 != null) rs1.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (pstm2 != null) pstm2.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (rs2 != null) rs2.close(); } catch (Exception e) { throw new RuntimeException(e); }
        }
    }

        /*
        * IATA Code to Currency method
        1. The event handler is triggered when the user selects an item from the IATA currency code dropdown menu.
        2. The showExchangeRate() method is called to display a pop-up window that shows the exchange rate information based on the selected IATA code.
        3. If the selected item in the dropdown menu is not "Select IATA Code", the code retrieves the exchange rate information from the openexchangerates.org API using a HTTP GET request.
        4. The API URL is constructed with a base currency of USD.
        5. A BufferedReader object is created to read the response from the API, which is in JSON format.
        6. The JSON response is parsed using the JSONObject class from the org.json library, and the exchange rate is extracted from the "rates" field based on the selected IATA code.
        7. The exchange rate is displayed in a label component on User Interface.
        *
        * */

    private void iataCurrencyCodeDDMenuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_iataCurrencyCodeDDMenuMenuActionPerformed
        // displays exchange rate depending on the selected IATA code

        ExchangeRate.showExchangeRate(iataCurrencyCodeDDMenu, showRateLabel);
        if (iataCurrencyCodeDDMenu.getSelectedItem().toString().equals("Select IATA Code")) {
            showRateLabel.setText(" ");
        } else {
            String apiURL = "https://openexchangerates.org/api/latest.json?app_id=c8d2619d67494c45b9fb6d1833872198&base=USD";

            try {
                URL url = new URL(apiURL);
                HttpURLConnection connection = (HttpURLConnection) url.openConnection();
                connection.setRequestMethod("GET");

                BufferedReader br = new BufferedReader(new InputStreamReader((connection.getInputStream())));
                String inputLine;
                StringBuilder sb = new StringBuilder();
                while ((inputLine = br.readLine()) != null) {
                    sb.append(inputLine);
                }
                br.close();

                JSONObject json = new JSONObject(sb.toString());
                JSONObject rates = json.getJSONObject("rates");
                double exchangeRate = rates.getDouble(iataCurrencyCodeDDMenu.getSelectedItem().toString());

                showRateLabel.setText(Double.toString(exchangeRate));
            } catch (Exception e) {
                throw new RuntimeException(e);
            }
        }
    }//GEN-LAST:event_iataCurrencyCodeDDMenuMenuActionPerformed

        /*
        * Create Ticket Button
        1. A random sale ID is produced in between 200 & 300.
        2. Depending on whether a customer is selected from the dropdown menu or if it is not there then it will lead you to creation of a new customer record in the database before a ticket is produced for them.
        3. The ticket is then created alongside a sales record inside the database.
        4. The ticket is then linked with the customer and sale ID.
        5. The sale record contains information about the sale, including the sale ID, the type of sale, the payment type, the amount payable in USD, and the exchange rate.
        6. The code then displays a message to the user indication whether the sale was successfully recorded and which menu the user can navigate to view the created ticketm customer record or sale record.
        *
        * */

    private void createTicketButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_createTicketButtonActionPerformed
        Random rand = new Random();
        int lower = 200;
        int upper = 300;
        int randomNum = rand.nextInt(upper - lower) + lower;

        int currentYear = java.time.LocalDate.now().getYear();
        String year = String.valueOf(currentYear);
        String saleID = year.substring(0, 2) + randomNum;

        String[] usernames = {forenameField.getText(), forenameField.getText() + surnameField.getText().charAt(0)};
        Random random = new Random();
        int index = random.nextInt(usernames.length);
        String username = usernames[index];

        StaffController staffController = new StaffController();
        Connection conn = null;
        PreparedStatement pstm1 = null;
        PreparedStatement pstm2 = null;
        PreparedStatement pstm3 = null;
        String createTicketQuery = null;
        String createSaleQuery = null;
        String createCustomerQuery = null;
        int pstm1Result = 0;
        int pstm2Result = 0;
        int pstm3Result = 0;
        Scanner scanner = new Scanner(System.in);
        RegularCustomer regCustomer;
        try {
            conn = DBConnection.getConnection();
            conn.setAutoCommit(false);

            if (customerNameDDMenu.getSelectedItem() == null && !(forenameField.getText().isEmpty())){
                createCustomerQuery = "INSERT INTO in2018g12.customer VALUES (?, ?, ?, ?, ?, ?)";
                pstm1 = conn.prepareStatement(createCustomerQuery);
                pstm1.setString(1, username);
                pstm1.setString(2, forenameField.getText());
                pstm1.setString(3, surnameField.getText());
                pstm1.setString(4, phoneField.getText());
                pstm1.setString(5, emailField.getText());
                pstm1.setString(6, "Regular");
                regCustomer = new RegularCustomer(username, forenameField.getText(), surnameField.getText(), phoneField.getText(), emailField.getText(), "Regular");
                pstm1Result = pstm1.executeUpdate();

                createTicketQuery = "INSERT INTO in2018g12.ticket VALUES (?, ?, ?, ?)";
                pstm2 = conn.prepareStatement(createTicketQuery);
                pstm2.setString(1, blankList.getSelectedValue());
                pstm2.setString(2, regCustomer.getUsername());
                pstm2.setString(3, saleID);
                if (plNoCheckbox.isSelected()){
                    pstm2.setString(4, "Paid");
                } else
                    pstm2.setString(4, null);
                pstm2Result = pstm2.executeUpdate();

                createSaleQuery = "INSERT INTO in2018g12.sale VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";
                pstm3 = conn.prepareStatement(createSaleQuery);
                pstm3.setString(1, saleID);
                //pstm3.setInt(2, staffController.getAdvisor().getId());
                pstm3.setString(3, typeOfSaleDDMenu.getSelectedItem().toString());
                pstm3.setString(4, String.valueOf(LocalDate.now()));
                pstm3.setString(5, paymentTypeDDMenu.getSelectedItem().toString());
                pstm3.setBigDecimal(6, BigDecimal.valueOf(Float.parseFloat(usdPayableLabel.getText())));
                pstm3.setString(7, iataCurrencyCodeDDMenu.getSelectedItem().toString() );
                pstm3.setString(8, exchangeRateLabel.getText());
                pstm3.setBigDecimal(9, BigDecimal.valueOf(Double.parseDouble(iataAmtLabel.getText())));
                pstm3.setBigDecimal(10, BigDecimal.valueOf(Double.parseDouble(taxAmountLabel.getText())));
                pstm3.setBigDecimal(11, BigDecimal.valueOf(Double.parseDouble(otherAmtLabel.getText())));
                pstm3.setBigDecimal(12, BigDecimal.valueOf(Double.parseDouble(subtotalAmtLabel.getText())));
                pstm3.setBigDecimal(13, BigDecimal.valueOf(Double.parseDouble(usdAmtLabel.getText())));
                if (plYesCheckbox.isSelected()){
                    pstm3.setString(14, "Yes");
                } else if (plNoCheckbox.isSelected()){
                    pstm3.setString(14, "No");
                }
                pstm3.setString(15, typeOfSaleDDMenu.getSelectedItem().toString());
                pstm3Result = pstm3.executeUpdate();

                if (pstm1Result > 0 && pstm2Result > 0 && pstm3Result > 0){
                    JOptionPane.showMessageDialog(this,
                            """
                            Sale has been recorded. To review, go to the 'View Individual Sales' menu
                            A new customer record has been created. To view, go to the 'View Customer Records' menu.
                            To review the created ticket, go to the 'View Tickets' menu.""");
                } else {
                    JOptionPane.showMessageDialog(this, "Could not create sale. " +
                            "Review details entered or contact system administrator");
                }
            } else {
                pstm3 = conn.prepareStatement(createTicketQuery);
                createTicketQuery = "INSERT INTO in2018g12.ticket VALUES (?, ?, ?, ?)";
                pstm3 = conn.prepareStatement(createTicketQuery);
                pstm3.setString(1, customerNameDDMenu.getSelectedItem().toString());
                pstm3.setString(2, saleID);
                pstm3.setString(3, blankList.getSelectedValue());
                if (plNoCheckbox.isSelected()){
                    pstm3.setString(4, "Paid");
                } else
                    pstm3.setString(4, null);
                pstm3Result = pstm3.executeUpdate();
                if (pstm3Result > 0){
                    JOptionPane.showMessageDialog(this,
                            """
                                    Sale has been recorded.
                                    To review the created ticket, go to the 'View Tickets' menu.
                                    To review your sale(s), go to the 'View Individual Sales' menu.""");
                } else {
                    JOptionPane.showMessageDialog(this, "Could not create sale. " +
                            "Review details entered or contact system administrator");
                }
            }
            conn.commit();
            conn.setAutoCommit(true);
        } catch (SQLException sqle) {
            if (conn != null) { try { conn.rollback(); } catch (SQLException e) { throw new RuntimeException(sqle); }}
        } finally {
            try { if (conn != null) conn.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (pstm1 != null) pstm1.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (pstm2 != null) pstm2.close(); } catch (Exception e) { throw new RuntimeException(e); }
            try { if (pstm3 != null) pstm3.close(); } catch (Exception e) { throw new RuntimeException(e); }
        }

    }//GEN-LAST:event_createTicketButtonActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(TicketSales.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(TicketSales.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(TicketSales.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TicketSales.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new TicketSales().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify
    private javax.swing.JComboBox<String> iataCurrencyCodeDDMenu;
    private javax.swing.JLabel IATACurrencyCodeLabel;
    private javax.swing.JLabel selectBlankLabel;
    private javax.swing.JList<String> blankList;
    private javax.swing.JScrollPane blankListSP;
    private javax.swing.JPanel buttonsPanel;
    private javax.swing.JPanel cardDetailsPanel;
    private javax.swing.JLabel cardDetailsPanelLabel;
    private javax.swing.JTextField cardNameField;
    private javax.swing.JLabel cardNameLabel;
    private javax.swing.JTextField cardNumberField;
    private javax.swing.JLabel cardNumberLabel;
    private javax.swing.JPanel convertedAmountPanel;
    private javax.swing.JButton createTicketButton;
    private javax.swing.JLabel customerDetailsLabel;
    private javax.swing.JPanel customerDetailsPanel;
    private javax.swing.JComboBox<String> customerNameDDMenu;
    private javax.swing.JLabel customerNameLabel;
    private javax.swing.JTextField cvvField;
    private javax.swing.JLabel cvvLabel;
    private javax.swing.JLabel dateLabel;
    private javax.swing.JTextField emailField;
    private javax.swing.JLabel emailLabel;
    private javax.swing.JLabel exchangeRateLabel;
    private javax.swing.JPanel existingCustomerPanel;
    private javax.swing.JLabel existingCustomerPanelLabel;
    private javax.swing.JTextField expDateField;
    private javax.swing.JLabel expDateLabel;
    private javax.swing.JButton findCustomerButton;
    private javax.swing.JTextField forenameField;
    private javax.swing.JLabel forenameLabel;
    private javax.swing.JButton homeButton;
    private javax.swing.JLabel iataAmtLabel;
    private javax.swing.JLabel iataPayableLabel;
    private javax.swing.JTextField issueNoField;
    private javax.swing.JLabel issueNoLabel;
    private javax.swing.JLabel logoLabel;
    private javax.swing.JPanel logoPanel;
    private javax.swing.JButton logoutButton;
    private javax.swing.JPanel newCustomerPanel;
    private javax.swing.JLabel newCustomerPanelLabel;
    private javax.swing.JLabel otherAmtLabel;
    private javax.swing.JLabel otherLabel;
    private javax.swing.JLabel pageTitleLabel;
    private javax.swing.JPanel pageTitlePanel;
    private javax.swing.JLabel payLaterLabel;
    private javax.swing.JComboBox<String> paymentTypeDDMenu;
    private javax.swing.JLabel paymentTypeLabel;
    private javax.swing.JTextField phoneField;
    private javax.swing.JLabel phoneLabel;
    private javax.swing.JCheckBox plNoCheckbox;
    private javax.swing.JCheckBox plYesCheckbox;
    private javax.swing.JButton viewTicketsPageButton;
    private javax.swing.JLabel saleDateLabel;
    private javax.swing.JButton selectCustomerButton;
    private javax.swing.JButton sellTicketPageButton;
    private javax.swing.JLabel showRateLabel;
    private javax.swing.JLabel subtotalAmtLabel;
    private javax.swing.JLabel subtotalLabel;
    private javax.swing.JTextField surnameField;
    private javax.swing.JLabel surnameLabel;
    private javax.swing.JLabel taxAmountLabel;
    private javax.swing.JLabel taxLabel;
    private javax.swing.JLabel ticketDetailsLabel;
    private javax.swing.JPanel ticketDetailsPanel;
    private javax.swing.JPanel ticketSalesPanel;
    private javax.swing.JComboBox<String> typeOfSaleDDMenu;
    private javax.swing.JLabel typeOfSaleLabel;
    private javax.swing.JLabel usdAmtLabel;
    private javax.swing.JLabel usdPayableLabel;
    private javax.swing.JButton viewIndSalesButton;
    // End of variables declaration
}
